
### **<font color=#99ccff>环境配置：</font>**

1.首先确保已经安装了nodejs
2.安装gulp到全局：npm install gulp -g
3.安装 npm依赖：将工程目录的package1.json改成package.json,运行：npm install；安装完成，将package.json改成package1.json，不改回来，白鹭的工程编译报错。


### **<font color=#99ccff>发布流程：</font>**
<br>一.语言文件处理 (如果文字没有对应的新增，可以跳过这步)
       1.抽取语言文件：gulp lang (-语言标识)  如 台湾繁体：gulp lang -zh-tw
       2.获取对应的繁体内容文件：将zh-tw.json的内容copy，然后转换成繁体，粘贴进zh-tw-complex.json(台湾繁体，其他语言类同)
       3.生成最终的语言映射文件：运行gulp lang-complex --v 0.1.0，生成最终的zh-tw.json文件 (里面包含中文简体对应的繁体对照)
       4.压缩语言文件：运行gulp zip-config,将语言文件压缩成最终的zip文件
<br>二.发布web版本
       1.双击[发布.bat],输入版本号（对应的版号文件夹，会生成在bin-release文件夹下），输入包名：，包的入口文件，为了有多个原生包同时存在而准备
       2.上传游戏资源文件至指定的地址。运行gulp upload --v 版本号（需要确认远程目录，是对的；如果需要删除远程目录，可以运行gulp rm-rf）
       至此web版本发布完毕
<br>三.原生包版本发布
      1.修改原生工程里面的gameurl，将新的游戏地址，赋值，即可。
      原生包是基于web包的，h5的打包方式，可以去白鹭官方教程去了解。
   
### **<font color=#99ccff>版本更新相关：</font>**
<br> web版本：先传资源，资源上传完毕之后，在传最后的index.html入口文件(同现在主流的web网页的更新方式)

<br> native版本：
online_version线上版本的意思

这个字段存在于两个地方：
 1.线上正式的xxx(包名).html文件里面
 2.安装包的gameurl里面（下面说的包，都是指安装包）

包的这个字段 大于线上的这个字段，说明是新包(新包分:提审阶段，释放阶段两个阶段,如过非强制更新包，则直接到释放阶段)

新包分为以下几种情况：
  1.如果是，全部大于，则需要强制更新客户端，才能进入游戏
  2.如果是，第二位大于，则是有优化包更新，可以不更新包也能进入游戏
  3.如果是，第三位大于，则是有热更新的内容，需要热更才能进入游戏
  说明：由于目前是gameurl链接的形式，第2,3步，可以看成网页式更新，不需要有优化包和热更新的方式更新游戏。

  新包运行读取的资源（这里的资源包括，js，图片，音频，等游戏资源，下面不在阐述），是新的，不同线上包读取的资源。

包的这个字段 等于 这个字段，说明是最新的线上包
读的资源是线上的。

包的这个字段 小于 这个字段，说明是旧包
读的资源也是线上的。

新包生效的操作：
将线上的版本提高到新包里面的版本号，同时将新的资源同步到线上资源引用数组，新包则生效。
何时操作？
如：在苹果提审成功之后，需要释放新包的时候。
详情见：micro/xxx.html

什么时候需要发新包？
当需要原生支持的时候，需要发新包，否则，可以直接走网页更新流程。

----

### **<font color=#99ccff>其它注意事项：</font>**

* 代码有修改更新，需要修改project.json的version的版本号
* 只有和安装包同步更新才能变动原生接口相关的代码

----

#### 原生：
* 通过打原生配置的游戏地址决定
#### Web版：
* url地址决定

----

### **<font color=#99ccff>获取数字包ID：</font>**

#### 原生：
* 通过安装包的bundleId映射到bundleId.json表获取
#### Web版：
* 通过url的参数bid直接获取，并通过bundleId.json表验证是否配置有

----

### **<font color=#99ccff>URL参数说明：</font>**

#### 原生：
* online_version：客户端版本号
#### Web版：
----

### **<font color=#99ccff>安全开关：</font>**
<font color=#cc99ff>(只有连接的是测试服和ios版才有效，只有ios提审用)</font>
#### 原生：
* 打开：RELEASE && window.web_config_isSafe = true
* 关闭：DEBUG || window.web_config_isSafe = false

#### Web版：没有安全开关

----
